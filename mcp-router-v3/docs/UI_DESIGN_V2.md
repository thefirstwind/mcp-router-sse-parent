# MCP Router v3 - 新版 UI 设计文档

## 📋 概述

新版 UI 设计专注于**突出 MCP 标准协议特点**，让 RESTful 请求、SSE 连接、MCP 连接等更加直观和易于理解。

## 🎯 设计目标

1. **协议可视化** - 清晰展示 MCP 标准协议（JSON-RPC 2.0）的特点
2. **连接状态透明** - 实时显示 SSE 连接状态、心跳、事件流
3. **消息流追踪** - 可视化请求-响应流程，支持 JSON-RPC 格式展示
4. **标准协议突出** - 强调 MCP 协议规范，包括 SSE 和 Streamable 传输协议
5. **更好的交互体验** - 现代化设计，响应式布局，实时更新

## 🎨 设计特色

### 1. 协议概览页面

#### 协议流程图
- **可视化流程**：展示 MCP 标准协议的三个关键步骤
  1. 建立连接：`GET /sse?serviceName=xxx`
  2. 发送消息：`POST /mcp/message?sessionId=xxx`
  3. 接收响应：SSE Event Stream

#### JSON-RPC 2.0 格式展示
- **语法高亮**：使用颜色区分 JSON 键、字符串、数字
- **结构清晰**：展示标准的 JSON-RPC 2.0 消息格式
- **实时示例**：显示实际的消息结构

#### 传输协议说明
- **SSE (Server-Sent Events)**
  - Content-Type: `text/event-stream`
  - 端点: `GET /sse/{serviceName}`
  - 心跳: 每 30 秒
  
- **Streamable (NDJSON)**
  - Content-Type: `application/x-ndjson`
  - 端点: `GET /mcp/{serviceName}`
  - 流式响应
  
- **RESTful**
  - 端点: `POST /mcp/router/route/{serviceName}`
  - 同步请求/响应
  - 无需会话管理

### 2. SSE 连接页面

#### 连接列表
- **实时状态**：显示连接状态（已连接/已断开）
- **会话信息**：Session ID、服务名称、最后活跃时间
- **筛选功能**：按服务名称、Session ID 筛选
- **点击查看详情**：选择连接查看详细信息

#### 连接详情
- **会话元数据**：Session ID、服务名称、状态、最后活跃时间
- **消息历史**：显示该会话的所有消息
- **消息格式**：展示 JSON-RPC 格式的消息内容

### 3. RESTful 请求页面

#### 请求列表
- **工具/方法显示**：优先显示工具名称，其次显示 MCP 方法
- **状态码**：使用颜色编码显示 HTTP 状态码
- **性能指标**：显示响应时间、服务名称
- **筛选功能**：按服务名称、MCP 方法、时间范围筛选

#### 请求详情
- **完整信息**：Request ID、路径、方法、状态码等
- **JSON-RPC 格式**：清晰展示请求和响应的 JSON-RPC 2.0 格式
- **语法高亮**：代码块使用深色主题，提高可读性

### 4. 消息流页面

#### 消息列表
- **时间线展示**：按时间顺序显示所有消息
- **类型标识**：使用颜色区分请求、响应、错误
- **完整内容**：显示请求体和响应体的完整内容
- **关联信息**：Session ID、服务名称、响应时间

#### 筛选功能
- 按 Session ID 筛选
- 按服务名称筛选
- 按消息类型筛选（请求/响应/错误）

## 🔧 技术实现

### 前端技术
- **纯 HTML/CSS/JavaScript**：无依赖，轻量级
- **现代 CSS**：使用 CSS Grid、Flexbox、CSS Variables
- **响应式设计**：支持桌面、平板、手机

### 设计系统
- **颜色方案**：
  - Primary: `#2563eb` (蓝色)
  - Success: `#10b981` (绿色)
  - Error: `#ef4444` (红色)
  - Warning: `#f59e0b` (橙色)
  
- **字体**：Inter 字体族，代码使用 Monaco/Courier New
- **阴影**：多层级阴影，增强视觉层次
- **圆角**：统一使用 8-12px 圆角

### 交互特性
- **实时更新**：每 15 秒自动刷新统计数据
- **点击交互**：点击列表项查看详情
- **筛选功能**：支持多维度筛选
- **加载状态**：显示加载动画和空状态

## 📊 数据展示优化

### 1. 统计卡片
- **大字体数值**：突出关键指标
- **描述文字**：清晰说明指标含义
- **悬停效果**：卡片悬停时轻微上移

### 2. 连接列表
- **状态徽章**：使用颜色和图标表示状态
- **元数据网格**：使用网格布局展示多个属性
- **选中状态**：清晰的选中反馈

### 3. 消息展示
- **代码块**：深色主题，提高可读性
- **类型标识**：使用颜色和标签区分消息类型
- **时间戳**：本地化时间格式

## 🎯 标准协议特点突出

### 1. JSON-RPC 2.0 格式
- **结构展示**：清晰展示 JSON-RPC 2.0 消息结构
- **语法高亮**：使用颜色区分不同元素
- **实时示例**：显示实际的消息格式

### 2. SSE 协议
- **连接状态**：实时显示连接状态
- **心跳监控**：显示心跳间隔和状态
- **事件流**：展示 SSE 事件流

### 3. 传输协议对比
- **多协议支持**：清晰展示支持的传输协议
- **协议特点**：说明每种协议的特点和用途
- **端点信息**：显示各协议的端点路径

## 🚀 使用指南

### 访问方式
```
http://localhost:8052/admin
```

### 页面导航
1. **协议概览**：了解 MCP 标准协议和传输协议
2. **SSE 连接**：监控和管理 SSE 连接
3. **RESTful 请求**：查看和分析 RESTful 请求
4. **消息流**：追踪消息的完整流程

### 常用操作
1. **查看连接**：点击 SSE 连接列表中的连接查看详情
2. **筛选请求**：使用筛选器查找特定请求
3. **查看消息**：在消息流页面查看完整的消息内容
4. **监控统计**：在顶部统计卡片查看系统状态

## 📈 性能优化

### 1. 数据加载
- **按需加载**：切换标签页时才加载数据
- **分页支持**：限制返回数量，避免性能问题
- **缓存机制**：前端缓存已加载的数据

### 2. 渲染优化
- **虚拟滚动**：长列表使用虚拟滚动（可扩展）
- **防抖处理**：输入框使用防抖，减少请求
- **懒加载**：详情内容按需加载

### 3. 网络优化
- **批量请求**：合并多个 API 请求
- **错误重试**：自动重试失败的请求
- **超时处理**：设置合理的请求超时时间

## 🔮 未来扩展

### 1. 实时通信
- **WebSocket**：实现真正的实时数据推送
- **Server-Sent Events**：服务器主动推送状态更新
- **长轮询**：作为 WebSocket 的降级方案

### 2. 图表可视化
- **Chart.js**：集成图表库，展示趋势
- **实时图表**：显示请求量、响应时间趋势
- **热力图**：展示服务调用热力图

### 3. 调试工具
- **消息重放**：重放历史消息
- **请求构造器**：可视化构造 JSON-RPC 请求
- **连接测试**：测试 SSE 连接

### 4. 高级功能
- **消息搜索**：全文搜索消息内容
- **导出功能**：导出日志和统计数据
- **告警配置**：配置告警规则

## 🎉 总结

新版 UI 设计通过以下方式突出 MCP 标准协议特点：

1. ✅ **协议可视化** - 清晰展示 JSON-RPC 2.0 格式和协议流程
2. ✅ **连接透明** - 实时显示 SSE 连接状态和消息流
3. ✅ **消息追踪** - 完整的请求-响应流程追踪
4. ✅ **标准突出** - 强调 MCP 协议规范和特点
5. ✅ **交互优化** - 现代化设计，更好的用户体验

这个 UI 使得 MCP Router v3 不仅是一个强大的路由服务，更是一个易于理解和使用 MCP 标准协议的管理工具。












